<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>libsequence: Sequence::PolyTableSlice&lt; T &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libsequence
   &#160;<span id="projectnumber">1.8.4</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classSequence_1_1PolyTableSlice.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Sequence::PolyTableSlice&lt; T &gt; Class Template Reference<div class="ingroups"><a class="el" href="group__popgen.html">Molecular Population Genetics</a> &raquo; <a class="el" href="group__popgenanalysis.html">Analysis of molecular population genetic data</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>A container class for "sliding windows" along a polymorphism table.  
 <a href="classSequence_1_1PolyTableSlice.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="PolyTableSlice_8hpp_source.html">Sequence/PolyTableSlice.hpp</a>&gt;</code></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename T&gt;<br />
class Sequence::PolyTableSlice&lt; T &gt;</h3>

<p>A container class for "sliding windows" along a polymorphism table. </p>
<p>This class is a simple container to store "sliding windows" along an object in the inheritance hierarchy of <a class="el" href="classSequence_1_1PolyTable.html" title="The base class for polymorphism tables. ">Sequence::PolyTable</a>.</p>
<p>Sliding windows are used in population genetics to look at variation in levels of diversity along a region. This class supports two simple ways to make such windows. The first is the slide a window of some length (in base pairs) along your sequence, recording the SNPs in each window. The number of base pairs that you move the window each time is the "step length." The second type of window is to slide a window of a constant number of segregating sites along the SNP table. In the latter case, the step length is the number of segregating sites by which to move the beginning of the window each time. The two different constructors for this class correspond to these two different window types.</p>
<p>These two types of window are useful in different contexts, and it's up to the user to decide which one s/he wants. Please note that all this class does is facilitate the generation of the windows. It does not address any of the statistical headaches that arise from sliding window analyses. These issues include multiple test correction, non-independence of overlapping windows, variation in selective constraing along a sequence, and variation in power from window to window with respect to hypothesis testing.</p>
<p>The user should be aware that the approach used in Kreitman and Hudson (1991) "Inferring the evoltionary histories of the Adh and Adh-dup loci in
Drosophila melanogaster from patterns of polymorphism and divergence." Genetics 127: 565 describe a clever variant of the sliding window. They slide along the physical sequence, but keep the number of synonymous/silent sites constant. Their procedure mitigates some of the difficulties mentioned above, but it is not implemented here because it relies on having an annotation for the SNP table available.</p>
<p>The user is also referred to Andolfatto, P., J. D. Wall and M. Kreitman, 1999 "Unusual haplotype structure at the proximal breakpoint of In(2L)t in a 
natural population of Drosophila melanogaster." Genetics 153:1397-1399, which discusses the multiple testing issue.</p>
<p>The following example reads in data from Hudson's program ms. Tajima's D is calculated for non-overlapping 100bp windows. It is assumed that 1000bp were simulated: </p><div class="fragment"><div class="line"><span class="preprocessor">#include&lt;<a class="code" href="SimData_8hpp.html">Sequence/SimData.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include&lt;<a class="code" href="SimParams_8hpp.html">Sequence/SimParams.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include&lt;<a class="code" href="PolyTableSlice_8hpp.html">Sequence/PolyTableSlice.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include&lt;<a class="code" href="PolySIM_8hpp.html">Sequence/PolySIM.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include&lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include&lt;cstdio&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line"><a class="code" href="classSequence_1_1SimParams.html">Sequence::SimParams</a> p;</div>
<div class="line">std::cin &gt;&gt; p;</div>
<div class="line"><a class="code" href="classSequence_1_1SimData.html">Sequence::SimData</a> d(p.totsam());</div>
<div class="line"><span class="keywordtype">int</span> i;</div>
<div class="line"><span class="keywordflow">while</span>( (i=d.fromstdin()) &amp;&amp; i != EOF) <span class="comment">//read simulated data from stdin</span></div>
<div class="line">{</div>
<div class="line"><a class="code" href="classSequence_1_1PolyTableSlice.html">Sequence::PolyTableSlice&lt;Sequence::SimData&gt;</a> windows(d.sbegin(),d.send(),100,100,1000,1000);</div>
<div class="line">PolyTableSlice&lt;Sequence::SimData&gt;::const_iterator itr = windows.begin();</div>
<div class="line"><span class="keywordflow">while</span>(itr &lt; windows.end()) <span class="comment">//iterate over windows</span></div>
<div class="line">{</div>
<div class="line"><span class="comment">//create a data object for the current window</span></div>
<div class="line">SimData window = windows.get_slice(itr);</div>
<div class="line"><span class="comment">//calculate and print Tajima&#39;s D for the window</span></div>
<div class="line">PolySIM analyze(&amp;window); </div>
<div class="line">std::cout &lt;&lt; analyze.<a class="code" href="classSequence_1_1PolySNP.html#ad236330defb0426b61265d3b955c6bef">TajimasD</a>() &lt;&lt; <span class="charliteral">&#39;\t&#39;</span>;</div>
<div class="line">}</div>
<div class="line">std::cout &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="line">}</div>
</div><!-- fragment --> <dl><dt><b>Examples: </b></dt><dd><a class="el" href="slidingWindow_8cc-example.html#_a4">slidingWindow.cc</a>, and <a class="el" href="slidingWindow2_8cc-example.html#_a3">slidingWindow2.cc</a>.</dd>
</dl>
<p>Definition at line <a class="el" href="PolyTableSlice_8hpp_source.html#l00114">114</a> of file <a class="el" href="PolyTableSlice_8hpp_source.html">PolyTableSlice.hpp</a>.</p>
</div><hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="PolyTableSlice_8hpp_source.html">PolyTableSlice.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceSequence.html">Sequence</a></li><li class="navelem"><a class="el" href="classSequence_1_1PolyTableSlice.html">PolyTableSlice</a></li>
    <li class="footer">Generated on Tue Dec 16 2014 15:56:56 for libsequence by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
