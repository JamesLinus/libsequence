<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>libsequence: Tutorial/overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libsequence
   &#160;<span id="projectnumber">1.8.4</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_md_tutorial.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Tutorial/overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This document is a rapid-fire overview of library features.</p>
<h2>Background</h2>
<p>I assume a working familiarity with:</p>
<ul>
<li>C++ and "C++11"</li>
</ul>
<h2>Input and output of biological sequences.</h2>
<p>A sequence is defined by the "pure virtual" class <a class="el" href="classSequence_1_1Seq.html" title="Abstract interface to sequence objects. ">Sequence::Seq</a>, which publicly inherits from std::pair&lt;std::string,std::string&gt;. The two members of the pair are the sequence name and the sequence itself, respectively.</p>
<p>A programmer may define new sequences via public inheritance from <a class="el" href="classSequence_1_1Seq.html" title="Abstract interface to sequence objects. ">Sequence::Seq</a>. The programmer must define the public member funtions Sequence::read and Sequence::print in order to make a valid class. See <a class="el" href="classSequence_1_1Fasta.html" title="FASTA sequence stream. ">Sequence::Fasta</a> and <a class="el" href="classSequence_1_1fastq.html">Sequence::fastq</a> for examples. These two functions (read/print) allow sequences to be read/written to/from C++ streams.</p>
<p><a class="el" href="classSequence_1_1Seq.html" title="Abstract interface to sequence objects. ">Sequence::Seq</a> defines several functions for data access and various biological operations (<a class="el" href="classSequence_1_1Seq.html#ac83a47f3bb7de9a0be61de360fccf623">Sequence::Seq::Revcom</a>, etc.).</p>
<h3>Reading and writing</h3>
<p>During read operations, a sequence object may throw an exception of type <a class="el" href="classSequence_1_1badFormat.html">Sequence::badFormat</a> if the data stream is not in the correct format. The built-int types (<a class="el" href="classSequence_1_1Fasta.html" title="FASTA sequence stream. ">Sequence::Fasta</a> and <a class="el" href="classSequence_1_1fastq.html">Sequence::fastq</a>) do not throw on write (although the output stream type could if something bad happens with the stream itself, etc.).</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Fasta_8hpp.html">Sequence/Fasta.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="classSequence_1_1Fasta.html">Sequence::Fasta</a> f;</div>
<div class="line"></div>
<div class="line">std::ifstream in(<span class="stringliteral">&quot;filename.fasta&quot;</span>)</div>
<div class="line"></div>
<div class="line"><span class="keyword">try</span> {</div>
<div class="line">in &gt;&gt; f &gt;&gt; std::wd;</div>
<div class="line">} <span class="keywordflow">catch</span> (<a class="code" href="classSequence_1_1badFormat.html">Sequence::badFormat</a> &amp; __b)</div>
<div class="line">{</div>
<div class="line">std::cerr &lt;&lt; __b &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line">exit(1);</div>
<div class="line">}</div>
</div><!-- fragment --><p>A sequence may be written to an output stream using the usual C++ output operator &lt;&lt;.</p>
<h3>Manipulating a sequence</h3>
<p><a class="el" href="classSequence_1_1Seq.html" title="Abstract interface to sequence objects. ">Sequence::Seq</a> provides obvious member functions for element access and iteration. Further, because a sequence inherits from std::pair&lt;std::string,std::string&gt;, a library user may use any of std::string's member functions as well:</p>
<div class="fragment"><div class="line">Sequence fasta f;</div>
<div class="line"><span class="comment">//This is the name, whose type is std::string</span></div>
<div class="line"><span class="keyword">auto</span> namelen = f.first.<a class="code" href="classSequence_1_1Seq.html#af131c8ce14feb9fbc25a4c8bf176caf6">size</a>();</div>
<div class="line"><span class="comment">//The sequence is also std::string:</span></div>
<div class="line"><span class="keyword">auto</span> seqlen = f.second.size();</div>
</div><!-- fragment --><p>You may also access the data in the sequence (but not the name!) using C++11 range-based for loops:</p>
<div class="fragment"><div class="line"><a class="code" href="classSequence_1_1Fasta.html">Sequence::Fasta</a> f(<span class="stringliteral">&quot;name&quot;</span>,<span class="stringliteral">&quot;TTT&quot;</span>);</div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">The for loop is equavalent to:</span></div>
<div class="line"><span class="comment">for( auto &amp; c : f.second )</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">for( auto &amp; c : f )</span></div>
<div class="line"><span class="comment">{</span></div>
<div class="line"><span class="comment">        c = &#39;CCC&#39;;</span></div>
<div class="line"><span class="comment">}</span></div>
</div><!-- fragment --><h4>Gzipped files, etc.</h4>
<p>For reading/writing compressed files, see the <a href="http://www.boost.org">boost</a>'s filtering_ostream libraries. They have been tested, and "just work" with libsequence objects.</p>
<p>Note: at the time of this writing (and as per my latest testing) the boost libraries do not support opening compressed streams in append mode. If you need to append to files, then buffer output to a std::ostringstream and write the buffer to a gzFile using <a href="http://zlib.net">zlib</a> directly:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;zlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line">std::ostringstream o;</div>
<div class="line"><span class="comment">//Fill o with stuff</span></div>
<div class="line"></div>
<div class="line">gzFile f = gzopen(<span class="stringliteral">&quot;file.gz&quot;</span>,<span class="stringliteral">&quot;a&quot;</span>);</div>
<div class="line"><span class="comment">//Write your data to the .gz file</span></div>
<div class="line">gzwrite(f,o.str().c_str(),o.str().size());</div>
<div class="line"><span class="comment">//Clear your buffer</span></div>
<div class="line">o.str(std::string());</div>
</div><!-- fragment --><h2>Testing for correct character sets</h2>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun Dec 14 2014 06:33:27 for libsequence by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
